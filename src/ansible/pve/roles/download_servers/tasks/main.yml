
- name: Create download folder
  ansible.builtin.file:
    path: '{{ storage.images.path }}/0'
    state: directory

- name: Download server images
  ansible.builtin.get_url:
    url: '{{ image.url }}'
    dest: '{{ storage.images.path }}/0/{{ image.os_file }}'
    checksum: '{{ image.checksum }}'
  with_items: '{{ os_images }}'
  loop_control:
    loop_var: image
  when: 'image.state == "present"'
